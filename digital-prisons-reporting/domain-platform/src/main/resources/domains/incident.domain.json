{
  "_comment": "DPR-128 Incident Domain",

  "id": "6b8c6f0e-c605-431d-a175-b3564b4d4114",
  "name": "incident",
  "description": "Initial incident domain for DPR Proof of Concept",
  "version": "0.0.1",
  "location": "/incident",
  "tags": {
    "department": "HMPPS",
    "unit": "Prisons"
  },
  "owner": "michael.w.clarke@justice.gov.uk",
  "author": "michael.w.clarke@justice.gov.uk",

  "tables": [
    {
      "name": "incident",
      "description": "Prisoner Incident Table",
      "version": "0.0.1",
      "location": "/incident",
      "tags": {
        "department": "HMPPS",
        "unit": "Prisons"
      },
      "owner": "michael.w.clarke@justice.gov.uk",
      "author": "michael.w.clarke@justice.gov.uk",

      "primaryKey": "id",
      "transform": {
        "viewText": "SELECT id, 'USE_OF_FORCE' as type, incident_date, agency_id, offender_no from public.report",
        "sources": ["public.report"]
      },
      "violations": []
    },
    {
      "name": "demographics",
      "description": "Prisoner Demographics Table",
      "version": "0.0.1",
      "location": "/demographics",
      "tags": {
        "department": "HMPPS",
        "unit": "Prisons"
      },
      "owner": "michael.w.clarke@justice.gov.uk",
      "author": "michael.w.clarke@justice.gov.uk",

      "primaryKey": "id",
      "transform": {
        "viewText": "select ob.offender_book_id as id, o.birth_date as birth_date, ob.living_unit_id as living_unit_id, o.first_name as first_name, o.last_name as last_name, o.offender_id_display as offender_no from nomis.offender_bookings ob join nomis.offenders o on ob.offender_id = o.offender_id",
        "sources": ["nomis.offender_bookings", "nomis.offenders"]
      },
      "violations": []
    }
  ]
}
